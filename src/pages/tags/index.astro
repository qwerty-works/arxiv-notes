---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const papers = await getCollection('papers');
const tagCounts = new Map();
for (const p of papers) {
  for (const t of p.data.tags) tagCounts.set(t, (tagCounts.get(t) || 0) + 1);
}
const tags = Array.from(tagCounts.entries()).sort((a,b) => b[1] - a[1]);

const title = 'Tags â€” arxiv-notes';
const description = 'Browse papers by tag.';

const BASE = import.meta.env.BASE_URL.endsWith('/')
  ? import.meta.env.BASE_URL
  : `${import.meta.env.BASE_URL}/`;
function href(path: string) {
  return `${BASE}${path.replace(/^\/+/, '')}`;
}
---

<BaseLayout title={title} description={description} canonical={'tags/'}>
  <section class="paper article">
    <h1>Tags</h1>
    <p class="subhead">Loose tags. Useful clustering. Minimal ceremony.</p>


    <div class="tags" style="margin-top:14px">
      {tags.map(([t, n]) => (
        <a class="tag" href={href(`tags/${encodeURIComponent(t)}/`)}>#{t} ({n})</a>
      ))}
    </div>
  </section>
</BaseLayout>
